# Uncharted Territory ゲームデザイン仕様書

## 1. ゲーム概要

### タイトル
Uncharted Territory（未知の領域）

### ジャンル
宇宙経済シミュレーションゲーム

### インスピレーション
- X3/X4シリーズ
- Factorio
- Elite Dangerous（経済要素）

### コアコンセプト
プレイヤーは無人貿易船団のオペレーターとして、ステーション間の交易により経済圏を確立していく。競合他社がひしめき合い、リアルタイムで変動する市場経済の中で、戦略的な判断により富を築き上げることが目標。

## 2. 世界観・ストーリー設定

### 時代背景
AIによる究極のオーケストレーションが実現した未来。人類は高度なAI技術により、宇宙進出を果たしている。

### 重要な技術設定
- **生体認証システム**: AIの暴走を防ぐため、全ての公式取引には人間の生体認証が必須
- **インパルスドライブ**: 光速に近い速度での宇宙航行を可能にする推進システム
- **ゲートシステム**: ワームホールを安定化させたセクター間移動装置
- **スペースストーム**: セクター間の接続をかく乱し、ゲートの行き先を変えてしまう宇宙現象。ゲーム開始時点では、大規模なスペースストームの発生直後の状況であり既知の3セクターを除き到達不能となっている。メタ的には、ゲームの範囲を徐々に拡大するための舞台装置。

## 3. ゲームプレイ

### 3.1 ゲームの目的
1. 既知の宇宙セクター、全3セクター内でチュートリアルの交易をこなす
2. 時間とともにランダムなセクターが解放される。効率的な交易ルートを確立し、経済的成功を収める
3. 獲得した利益で船団を拡大し、より大規模な経済活動を展開する

### 3.2 勝利条件
明確なエンディングはなく、以下のような目標を自由に追求できる：
- 一定額（例：1,000,000クレジット）の資産達成
- 最適な交易ルートの確立と自動化
- 大規模船団の構築、自分の工場の建設

### 3.3 ゲームオーバー条件
なし（サンドボックス型のゲームプレイ）

## 4. ゲームメカニクス

### 4.1 基本アクション

#### 発見（Explore）
- 時間とともにスペースストームが収まり、新しいセクターが自動的に発見される
- 各セクターはプロシージャル生成され、独自のステーション配置を持つ
- 各セクターは最大4つのゲートを持つ。新しく発見されたセクターがどこにつながるかはランダム。

#### 移動（Move）
- セクター内の任意の座標への移動指示
- ステーションやゲートへの自動移動
- 移動速度：最大600m/s（インパルスドライブ使用時）

#### 交易（Trade）
- ステーションから200m以内で商品の売買が可能
- 船舶の積載容量の範囲内で取引
- 価格は在庫量により動的に変動

#### 交易AI
- AIが利益最大化のための交易ルートを自動計算・実行
- まとめ役のAIが、各プレイヤー（NPCプレイヤー含む）につき一つ存在する
- まとめ役が、一定時間間隔で既知の交易機会から一定以上の利益が見込めるものをオークションに出す。
- 各貿易船は、自分の位置と交易完了までにかかる時間から、利益割る時間で時間当たり利益を計算し、オークションに入札する。最高の利益の貿易船が落札し実行する。
- 右往左往するのを防ぐため、貿易船は落札後は目的地を変えない。買えない/売れない場合は、解消するまで買い先・売り先で待機する。
- まとめ役は、落札後、進行中の貿易が重複してオークションに出ないように管理する（在庫を取りおく）

### 4.2 経済システム

#### 商品カテゴリと流通
- **原料**: ore（鉱石）、silicon（シリコン）、ice（氷）
- **中間財**: microchips（マイクロチップ）、quantum_tubes（量子管）
- **完成品**: hull_parts（船体部品）、food（食料）

#### 価格決定メカニズム
```
価格 = 最高価格 - ((最高価格 - 最低価格) × 在庫率)
```
- 在庫率0%（在庫なし） → 最高価格
- 在庫率100%（在庫満杯） → 最低価格
- 価格変動幅：基準価格の±30%

#### 生産サイクル
- 60秒ごとに各ステーションで生産・消費活動が発生
- 生産量と消費量はステーションタイプにより固定

### 4.3 ステーションタイプ

1. **鉱山（Mine）**
   - 原料を生産
   - 売却のみ可能

2. **工場（Factory）**
   - 原料を消費して製品を生産
   - 特定の入力と出力を持つ

3. **交易港（Trading Hub）**
   - 全商品を扱うが生産はしない
   - 売買両方が可能
   - 価格調整の中心的役割

### 4.4 セクターシステム
- 初期3セクター
- 各セクターは2000m × 2000mの空間
- セクター間はゲートで接続
- プロシージャル生成により毎回異なるレイアウト

## 5. プレイヤー進行

### 5.1 初期状態
- 開始セクター：Neter（Sector 0）
- 初期資金：100,000クレジット
- 初期船舶：貨物船「Mercury」×1隻
  - 積載容量：1000
  - 移動速度：600m/s

### 5.2 成長曲線
1. **序盤**（0〜30分）
   - チュートリアルで初期セクターでの基本的な交易を学習
   - 資金を200,000クレジットまで増やす

2. **中盤**（30分〜2時間）
   - 複数セクターにまたがる交易ルートの確立
   - 自動交易の活用

3. **終盤**（2時間以降）
   - 最適化された交易ネットワークの構築
   - 新船舶の購入、艦隊の編成

## 6. UI/UX設計

### 6.1 画面レイアウト
- Mini metroインスパイヤの、ミニマリストで滑らかに拡大縮小できるUI
- **左パネル（フローティングウインドウ）**：船舶リスト、ステータスログ
- **中央エリア**：自在にマウスホイールで拡大縮小でき、右クリックでパンできる、マップ。マップは常に既知宇宙全体を表示し、各セクターは四角形で囲まれた領域で表現される。ゲートとゲートでセクター間が接続されている。ゲートの間のワームホールは、滑らかな曲線コネクタで表現される。
- **右パネル（フローティングウインドウ）**：ステーション一覧、在庫・価格情報

### 6.2 操作方法
- マウス左クリック：移動指示、艦船、ステーション/ゲート選択
- マウス右クリック：マップのパン、キャンセル操作
- マウスホイール：マップの拡大縮小
- 船舶メニュー：艦船を選択すると表示される。Auto-Trade切り替え、貨物の表示など

### 6.3 情報表示
- リアルタイム更新（30Hz）
- 船舶位置、速度、積荷状況
- ステーション在庫と価格
- 収支履歴

### 6.4 カラースキーム
- 黒、白、蛍光ピンク、蛍光グリーン、蛍光ブルーなど、サイバーなカラースキーム。未来的な印象。

## 7. 技術仕様

### 7.1 ゲーム更新サイクル
- サーバー側：60Hz（16.67ms間隔）
- クライアント側：30Hz（33.33ms間隔）でのWebSocket更新

### 7.2 ネットワーク設計
- WebSocketによるリアルタイム双方向通信
- ステートレスなコマンド送信
- Durable objectsを活用したゲーム状態管理

### 7.3 データ永続化
- Durable Objects（Cloudflare Workers）によるゲーム状態保存

### 7.4 基本仕様
- モノレポ構成
- cloudflareの機能を活用してユーザー認証する。
- Cloudflare workersでサーバレスで実現する。

## 8. バランス設計指針

### 経済バランス
- インフレーションを防ぐための価格調整メカニズム
- 常に材料の供給が多めになり、加工段階が進むとともに量が減って量当たりの価格が上がっていく
- 貿易港の在庫は自動的に消費される（経済のシンク）

この仕様書は、新規実装の際の設計指針として使用されることを想定しています。実装の詳細は、この上位設計に基づいて決定されるものとします。